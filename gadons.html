<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DERVESH CARGO SERVICES ‚Äî Home</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;700;800&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --deep-green:#134b2b;
      --muted-green:#eaf4ec;
      --accent:#0f3f25;
      --card-shadow:0 8px 30px rgba(7,20,10,0.18);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Montserrat',system-ui,Arial;background:linear-gradient(180deg,#f7fbf8 0%, #e9f3ec 100%);color:#213321;min-height:100vh;display:flex;flex-direction:column}
    header{background:var(--deep-green);color:#fff;padding:16px 40px;display:flex;align-items:center;justify-content:space-between;box-shadow:var(--card-shadow)}
    header h1{font-family:'Playfair Display';font-size:24px;letter-spacing:1px}
    nav{display:flex;gap:20px}
    nav a{color:#fff;text-decoration:none;font-weight:600;transition:color .2s}
    nav a:hover{color:#c9f1d8}

    .hero{flex:1;display:flex;align-items:center;justify-content:center;text-align:center;padding:60px 20px;background:url('https://images.unsplash.com/photo-1543362906-acfc16c67564?ixlib=rb-4.0.3&auto=format&fit=crop&w=1400&q=80') center/cover no-repeat;color:#fff;position:relative}
    .hero::after{content:'';position:absolute;inset:0;background:rgba(19,75,43,0.55)}
    .hero-content{position:relative;z-index:2}
    .hero h2{font-size:42px;font-family:'Playfair Display';margin-bottom:10px}
    .hero p{font-size:16px;max-width:600px;margin:0 auto}

    .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:24px;padding:40px;max-width:1200px;margin:0 auto}
    .card{background:#fff;padding:28px;border-radius:18px;box-shadow:var(--card-shadow);transition:transform .25s;text-decoration:none;color:inherit;display:block}
    .card:hover{transform:translateY(-6px)}
    .card h3{color:var(--deep-green);margin-bottom:10px;font-size:18px}
    .card p{font-size:14px;color:#4b5a4b}

    footer{background:#123c25;color:#d7e9db;padding:20px;text-align:center;font-size:13px}
  </style>
</head>
<body>
  <header>
    <h1>DERVESH CARGO SERVICES</h1>
    <nav>
      <a href="booking.html">Booking</a>
      <a href="details.html">Booking Details</a>
      <a href="gadons.html">Gadon</a>
      <a href="accounts.html">Accounts</a>
      <a href="daybook.html">Daybook</a>
    </nav>
  </header>
<head>
  <meta charset="UTF-8">
  <title>Darvesh Cargo - Warehouse & Gate Pass</title>
  <style>
    body { font-family: Arial, sans-serif; background:#134B2B; margin:20px; }
    h1, h2 { text-align:center; color:#FFFF; }
    .container { max-width:1200px; margin:auto; }
    .card { background:#fff; padding:20px; margin:15px 0; border-radius:10px; box-shadow:0 3px 6px rgba(0,0,0,0.1); }
    input, button, select { padding:8px; margin:5px; border:1px solid #ccc; border-radius:6px; }
    button { background:#185f37; color:#fff; cursor:pointer; }
    button:hover { background:#185f37; }
    table { width:100%; border-collapse:collapse; margin-top:15px; }
    th, td { border:1px solid #ddd; padding:8px; text-align:center; }
    th { background:#3498db; color:#fff; }
    .search-bar { margin:10px 0; text-align:right; }
    .ledger-box { background:#fafafa; padding:10px; margin:10px 0; border-left:4px solid #3498db; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üì¶ Darvesh Cargo - Godown</h1>

    <!-- Add Entry -->
    <div class="card">
      <h2>Add Stock Entry</h2>
      <input type="text" id="party" placeholder="Party Name">
      <input type="text" id="item" placeholder="Item Name">
      <input type="number" id="quantity" placeholder="Quantity">
      <input type="number" id="weight" placeholder="Weight (kg)">
      <input type="text" id="remarks" placeholder="Remarks">
      <button onclick="addStock()">Add Entry</button>
    </div>

    <!-- Search + Stock List -->
    <div class="card">
      <h2>Godown Stock</h2>
      <div class="search-bar">
        <input type="text" id="search" placeholder="üîç Search by Party or Item" onkeyup="renderStock()">
      </div>
      <table>
        <thead>
          <tr>
            <th>Party</th><th>Item</th><th>Qty</th><th>Weight</th><th>Remarks</th><th>Action</th>
          </tr>
        </thead>
        <tbody id="stockTable"></tbody>
      </table>
    </div>

    <!-- Ledger -->
    <div class="card">
      <h2>üìë Party Ledger</h2>
      <div id="ledgerList"></div>
    </div>
  </div>

  <script>
    let stock = JSON.parse(localStorage.getItem("godownStock")) || [];
    let ledger = JSON.parse(localStorage.getItem("partyLedger")) || {};

    function addStock() {
      let party = document.getElementById("party").value;
      let item = document.getElementById("item").value;
      let quantity = parseInt(document.getElementById("quantity").value);
      let weight = parseFloat(document.getElementById("weight").value);
      let remarks = document.getElementById("remarks").value;

      if (!party || !item || isNaN(quantity) || isNaN(weight)) {
        alert("‚ùå Fill all fields!");
        return;
      }

      stock.push({ party, item, quantity, weight, remarks });
      localStorage.setItem("godownStock", JSON.stringify(stock));

      // Ledger add
      if (!ledger[party]) {
        ledger[party] = { totalQty: 0, totalWeight: 0, history: [] };
      }
      ledger[party].totalQty += quantity;
      ledger[party].totalWeight += weight;
      ledger[party].history.push({
        date: new Date().toLocaleString(),
        type: "Stock In",
        item, qty: quantity, weight, remarks
      });
      localStorage.setItem("partyLedger", JSON.stringify(ledger));

      renderStock();
      renderLedger();

      document.getElementById("party").value = "";
      document.getElementById("item").value = "";
      document.getElementById("quantity").value = "";
      document.getElementById("weight").value = "";
      document.getElementById("remarks").value = "";
    }

    function renderStock() {
      let search = document.getElementById("search").value.toLowerCase();
      let rows = "";
      stock.forEach((s, i) => {
        if (s.party.toLowerCase().includes(search) || s.item.toLowerCase().includes(search)) {
          rows += `<tr>
            <td>${s.party}</td>
            <td>${s.item}</td>
            <td>${s.quantity}</td>
            <td>${s.weight}</td>
            <td>${s.remarks}</td>
            <td>
              <button onclick="printGatePass(${i})">üìù Gate Pass</button>
            </td>
          </tr>`;
        }
      });
      document.getElementById("stockTable").innerHTML = rows;
    }

    function printGatePass(index) {
      const entry = stock[index];
      let passQty = parseInt(prompt(`Enter Quantity (Available: ${entry.quantity})`, entry.quantity));
      let passWeight = parseFloat(prompt(`Enter Weight (Available: ${entry.weight} kg)`, entry.weight));

      if (isNaN(passQty) || passQty <= 0 || passQty > entry.quantity) { alert("‚ùå Invalid Qty!"); return; }
      if (isNaN(passWeight) || passWeight <= 0 || passWeight > entry.weight) { alert("‚ùå Invalid Weight!"); return; }

      let gatePass = `
        <h2 style="text-align:center;">Darvesh Cargo - Gate Pass</h2>
        <p><strong>Party:</strong> ${entry.party}</p>
        <p><strong>Item:</strong> ${entry.item}</p>
        <p><strong>Quantity:</strong> ${passQty}</p>
        <p><strong>Weight:</strong> ${passWeight} kg</p>
        <p><strong>Remarks:</strong> ${entry.remarks}</p>
        <p><strong>Date:</strong> ${new Date().toLocaleString()}</p>
        <hr><p style="text-align:center;">Authorized Sign & Stamp</p>
      `;
      const win = window.open("", "PrintWindow");
      win.document.write(gatePass);
      win.print();
      win.close();

      // update stock
      entry.quantity -= passQty;
      entry.weight -= passWeight;
      if (entry.quantity <= 0 || entry.weight <= 0) stock.splice(index, 1);

      // update ledger
      ledger[entry.party].totalQty -= passQty;
      ledger[entry.party].totalWeight -= passWeight;
      ledger[entry.party].history.push({
        date: new Date().toLocaleString(),
        type: "Gate Pass Out",
        item: entry.item,
        qty: -passQty,
        weight: -passWeight,
        remarks: entry.remarks
      });

      localStorage.setItem("godownStock", JSON.stringify(stock));
      localStorage.setItem("partyLedger", JSON.stringify(ledger));

      renderStock();
      renderLedger();
    }

    function renderLedger() {
      let html = "";
      for (let party in ledger) {
        let l = ledger[party];
        html += `<div class="ledger-box">
          <h3>${party}</h3>
          <p><b>Total Qty:</b> ${l.totalQty}, <b>Total Weight:</b> ${l.totalWeight} kg</p>
          <details>
            <summary>üìñ History</summary>
            <ul>${l.history.map(h => `<li>${h.date} - ${h.type} - ${h.item} (${h.qty}, ${h.weight}kg) [${h.remarks}]</li>`).join("")}</ul>
          </details>
        </div>`;
      }
      document.getElementById("ledgerList").innerHTML = html;
    }

    renderStock();
    renderLedger();
  </script>
</body>
</html>
